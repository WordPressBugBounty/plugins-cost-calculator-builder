{"version":3,"file":"MultiPoint-BthulZ7u.js","sources":["../../src/widget/features/calculator-fields/components/Range/styles/MultiPoint.vue"],"sourcesContent":["<template>\n  <div\n    class=\"slider-wrapper ccb-multi-point-range-field\"\n    :class=\"{ jump: field.jump }\"\n  >\n    <div class=\"slider-min-max\">\n      <div class=\"slider-min-max-item first\" @click=\"handleClick(min)\">\n        <span class=\"tick\"></span>\n        <span class=\"label\">{{ min }}</span>\n      </div>\n      <div\n        class=\"slider-min-max-item\"\n        :class=\"{ done: value >= max }\"\n        @click=\"handleClick(max)\"\n      >\n        <span class=\"tick\"></span>\n        <span class=\"label\">{{ max }}</span>\n      </div>\n    </div>\n    <Slider\n      v-model=\"value\"\n      :min=\"min\"\n      :max=\"max\"\n      :step=\"step\"\n      :disabled=\"field.disabled\"\n      show-tooltip=\"focus\"\n      class=\"custom-slider\"\n      :format=\"getFormatValue\"\n    />\n    <div class=\"custom-marks\">\n      <div\n        v-for=\"point in scalePoints\"\n        :key=\"point\"\n        class=\"mark\"\n        :style=\"getMarkStyle(point)\"\n        v-if=\"field.scalePoints\"\n      >\n        <div\n          class=\"tick\"\n          v-if=\"point !== min && point !== max\"\n          :class=\"{ 'tick-passed': point <= Number(DinamicLabel) }\"\n        />\n        <div\n          class=\"label\"\n          :class=\"{ 'label-passed': point <= Number(DinamicLabel) }\"\n          @click=\"handleClick(point)\"\n          v-if=\"point !== min && point !== max\"\n        >\n          {{ point }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { toRefs, computed, watch, ref, onBeforeUnmount, onMounted } from \"vue\";\nimport Slider from \"@vueform/slider\";\nimport { IRangeField } from \"@/widget/shared/types/fields\";\n\ntype Props = {\n  field: IRangeField;\n  modelValue: number;\n};\n\nconst props = defineProps<Props>();\nconst emit = defineEmits<{\n  (event: \"update:modelValue\", value: number): void;\n}>();\n\nconst realValue = ref(props.modelValue);\n\nconst { field } = toRefs(props);\n\nconst value = computed({\n  get: () => props.modelValue,\n  set: (val) => emit(\"update:modelValue\", val),\n});\n\nconst min = computed(() => Number(field.value.min));\nconst max = computed(() => Number(field.value.max));\nconst step = computed(() =>\n  field.value.jump ? 1 : Number(field.value.step || 1),\n);\nconst jump = computed(() => field.value.jump);\n\nconst scalePoints = computed(() => {\n  const raw = field.value.scalePoints?.trim() || \"\";\n  return raw\n    .split(\",\")\n    .map((p) => Number(p.trim()))\n    .filter((p) => !isNaN(p) && p >= min.value && p <= max.value);\n});\n\nconst handleClick = (point: number) => {\n  if (jump.value && scalePoints.value.includes(point)) {\n    DinamicLabel.value = point.toString();\n    emit(\"update:modelValue\", point);\n  }\n};\n\nconst getMarkStyle = (point: number) => {\n  const percentage = ((point - min.value) / (max.value - min.value)) * 100;\n  return {\n    left: `${percentage}%`,\n  };\n};\n\nwatch(\n  () => props.modelValue,\n  (val) => {\n    realValue.value = val;\n    DinamicLabel.value = val.toString();\n  },\n);\n\nconst getFormatValue = (num: number): string => {\n  const rounded = num.toFixed(2);\n  return parseFloat(rounded).toString();\n};\n\nlet observer: MutationObserver;\n\nlet DinamicLabel = ref(\"0\");\n\nonMounted(() => {\n  if (field.value.defaultValue) {\n    DinamicLabel.value = field.value.defaultValue.toString();\n  }\n\n  const tooltipEl = document.querySelector(\n    `[data-id=\"${field.value.alias}\"] .slider-tooltip`,\n  );\n\n  if (tooltipEl) {\n    observer = new MutationObserver((mutations) => {\n      for (const mutation of mutations) {\n        if (mutation.type === \"childList\") {\n          setTimeout(() => {\n            DinamicLabel.value = tooltipEl.textContent ?? \"\";\n          }, 130);\n        }\n      }\n    });\n\n    observer.observe(tooltipEl, {\n      childList: true,\n      subtree: true,\n      characterData: true,\n    });\n  }\n});\n\nonBeforeUnmount(() => {\n  if (observer) observer.disconnect();\n});\n\nwatch(realValue, (val) => {\n  if (jump.value) {\n    const closestPoint = scalePoints.value.reduce(\n      (prev, curr) =>\n        Math.abs(curr - val) < Math.abs(prev - val) ? curr : prev,\n      scalePoints.value[0],\n    );\n    emit(\"update:modelValue\", closestPoint);\n  } else {\n    emit(\"update:modelValue\", val);\n  }\n});\n</script>\n\n<style lang=\"scss\">\n.ccb-multi-point-range-field {\n  position: relative;\n  padding: 15px 0px 35px 0px;\n\n  &.jump {\n    .custom-marks {\n      z-index: 2;\n    }\n\n    .slider-handle {\n      pointer-events: none;\n    }\n\n    .slider-min-max-item {\n      .label {\n        cursor: pointer;\n        pointer-events: auto;\n      }\n    }\n\n    .custom-marks {\n      .label {\n        cursor: pointer;\n        pointer-events: auto;\n      }\n    }\n  }\n\n  .slider-min-max {\n    display: flex;\n    width: 102%;\n    justify-content: space-between;\n    align-items: center;\n    position: absolute;\n    top: 13px;\n    left: 0;\n\n    &-item {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n\n      &.first {\n        .tick {\n          background: var(--ccb-accent-color);\n        }\n      }\n\n      &.done {\n        .tick {\n          background-color: var(--ccb-accent-color);\n        }\n      }\n    }\n\n    .tick {\n      height: 8px;\n      width: 8px;\n      border-radius: 50%;\n      background: color-mix(in srgb, var(--ccb-container-color), black 10%);\n      margin: 0 auto 4px;\n    }\n\n    .label {\n      color: var(--ccb-fields-description-color);\n      font-size: 12px;\n      font-weight: 500;\n      line-height: 100%;\n      padding-top: 10px;\n      pointer-events: none;\n    }\n  }\n\n  .custom-marks {\n    position: absolute;\n    right: -13px;\n    top: 13px;\n    width: 105%;\n    transform: scaleX(0.94);\n  }\n\n  .mark {\n    position: absolute;\n    transform: translateX(-50%);\n    text-align: center;\n\n    .label {\n      color: var(--ccb-fields-description-color);\n      font-size: 12px;\n      font-weight: 500;\n      line-height: 100%;\n      padding-top: 10px;\n    }\n  }\n\n  .tick {\n    height: 8px;\n    width: 8px;\n    border-radius: 50%;\n    background: color-mix(in srgb, var(--ccb-container-color), black 10%);\n    margin: 0 auto 4px;\n\n    &.tick-passed {\n      background: var(--ccb-accent-color) !important;\n    }\n  }\n\n  .slider-origin {\n    width: 105%;\n    right: -13px;\n  }\n\n  .slider-base {\n    transform: scale(0.94);\n    background-color: color-mix(\n      in srgb,\n      var(--ccb-container-color),\n      black 10%\n    ) !important;\n  }\n  .slider-horizontal {\n    height: 4px !important;\n    border-radius: 10px;\n  }\n\n  .slider-tooltip {\n    border-radius: 15px;\n    font-size: 12px;\n    font-weight: 700;\n    padding: 6px 10px;\n    line-height: 100%;\n\n    &::after,\n    &::before {\n      display: none;\n    }\n  }\n}\n</style>\n"],"names":["props","__props","emit","__emit","realValue","ref","field","toRefs","value","computed","val","min","max","step","jump","scalePoints","_a","p","handleClick","point","DinamicLabel","getMarkStyle","watch","getFormatValue","num","rounded","observer","onMounted","tooltipEl","mutations","mutation","onBeforeUnmount","closestPoint","prev","curr"],"mappings":"qbAiEA,MAAMA,EAAQC,EACRC,EAAOC,EAIPC,EAAYC,EAAIL,EAAM,UAAU,EAEhC,CAAE,MAAAM,CAAA,EAAUC,EAAOP,CAAK,EAExBQ,EAAQC,EAAS,CACrB,IAAK,IAAMT,EAAM,WACjB,IAAMU,GAAQR,EAAK,oBAAqBQ,CAAG,CAAA,CAC5C,EAEKC,EAAMF,EAAS,IAAM,OAAOH,EAAM,MAAM,GAAG,CAAC,EAC5CM,EAAMH,EAAS,IAAM,OAAOH,EAAM,MAAM,GAAG,CAAC,EAC5CO,EAAOJ,EAAS,IACpBH,EAAM,MAAM,KAAO,EAAI,OAAOA,EAAM,MAAM,MAAQ,CAAC,CACrD,EACMQ,EAAOL,EAAS,IAAMH,EAAM,MAAM,IAAI,EAEtCS,EAAcN,EAAS,IAAM,OAE1B,SADKO,EAAAV,EAAM,MAAM,cAAZ,YAAAU,EAAyB,SAAU,IAE5C,MAAM,GAAG,EACT,IAAKC,GAAM,OAAOA,EAAE,KAAA,CAAM,CAAC,EAC3B,OAAQA,GAAM,CAAC,MAAMA,CAAC,GAAKA,GAAKN,EAAI,OAASM,GAAKL,EAAI,KAAK,CAAA,CAC/D,EAEKM,EAAeC,GAAkB,CACjCL,EAAK,OAASC,EAAY,MAAM,SAASI,CAAK,IACnCC,EAAA,MAAQD,EAAM,SAAS,EACpCjB,EAAK,oBAAqBiB,CAAK,EAEnC,EAEME,EAAgBF,IAEb,CACL,KAAM,IAFaA,EAAQR,EAAI,QAAUC,EAAI,MAAQD,EAAI,OAAU,GAEhD,GACrB,GAGFW,EACE,IAAMtB,EAAM,WACXU,GAAQ,CACPN,EAAU,MAAQM,EACLU,EAAA,MAAQV,EAAI,SAAS,CAAA,CAEtC,EAEM,MAAAa,EAAkBC,GAAwB,CACxC,MAAAC,EAAUD,EAAI,QAAQ,CAAC,EACtB,OAAA,WAAWC,CAAO,EAAE,SAAS,CACtC,EAEI,IAAAC,EAEAN,EAAef,EAAI,GAAG,EAE1B,OAAAsB,EAAU,IAAM,CACVrB,EAAM,MAAM,eACdc,EAAa,MAAQd,EAAM,MAAM,aAAa,SAAS,GAGzD,MAAMsB,EAAY,SAAS,cACzB,aAAatB,EAAM,MAAM,KAAK,oBAChC,EAEIsB,IACSF,EAAA,IAAI,iBAAkBG,GAAc,CAC7C,UAAWC,KAAYD,EACjBC,EAAS,OAAS,aACpB,WAAW,IAAM,CACFV,EAAA,MAAQQ,EAAU,aAAe,IAC7C,GAAG,CAEV,CACD,EAEDF,EAAS,QAAQE,EAAW,CAC1B,UAAW,GACX,QAAS,GACT,cAAe,EAAA,CAChB,EACH,CACD,EAEDG,EAAgB,IAAM,CAChBL,KAAmB,WAAW,CAAA,CACnC,EAEKJ,EAAAlB,EAAYM,GAAQ,CACxB,GAAII,EAAK,MAAO,CACR,MAAAkB,EAAejB,EAAY,MAAM,OACrC,CAACkB,EAAMC,IACL,KAAK,IAAIA,EAAOxB,CAAG,EAAI,KAAK,IAAIuB,EAAOvB,CAAG,EAAIwB,EAAOD,EACvDlB,EAAY,MAAM,CAAC,CACrB,EACAb,EAAK,oBAAqB8B,CAAY,CAAA,MAEtC9B,EAAK,oBAAqBQ,CAAG,CAC/B,CACD"}