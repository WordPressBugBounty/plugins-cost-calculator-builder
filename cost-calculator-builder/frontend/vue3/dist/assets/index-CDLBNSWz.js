const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Buttons-CJldvQ5_.css"])))=>i.map(i=>d[i]);
import{a as Ce,C as Ne,k as w,b as P,e as Y,_ as Z,o as ke,m as N,g as _,p as q,q as k,f as W,u as o,D as x,r as Fe,I as ee}from"./convert-case-to-camel-case.utils-DRsbC-qG.js";import{m as Me,u as Ve,c as Pe,n as Qe,d as Ie,a as O,l as $e,o as Te}from"./widget-aE3IoCbC.js";import{_ as te}from"./RequiredHint.vue_vue_type_style_index_0_lang-DFYyucnB.js";import{u as qe}from"./translationsStore-C34buciO.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const ne=I=>{if(I===void 0||(I==null?void 0:I.length)<0)return!1;const U=/^[-+]?[0-9]+\.[0-9]+$/;return!!I.toString().match(U)},Re={class:"ccb-field__label"},we={key:0,class:"ccb-required-tooltip"},De={class:"ccb-field__title"},Be=["id"],Ee={key:0,class:"ccb-field-required-mark"},Oe={key:0,class:"ccb-field__descriptions ccb-before"},Ue={key:0,class:"ccb-field__description"},je={key:1,class:"ccb-field__description"},ze={key:1,class:"ccb-field__descriptions ccb-after"},Ke={key:0,class:"ccb-field__description"},Le={key:1,class:"ccb-field__description"},We={class:"ccb-field__badge-content"},He={key:0,class:"ccb-icon-price-tag"},Ge={class:"ccb-field__badge-text"},Je={class:"ccb-field__badge-value"},Xe=Ce({__name:"Quantity",props:{field:{}},setup(I){const U=I,{field:e}=Ne(U),D=w("required"),re=P(()=>`ccb_quantity_${e.value.alias}`),H=P(()=>`ccb_label_${e.value.alias}`),ie=Me(),v=$e(),G=Ve(),B=Pe(),ae=Qe(),A=Te(),T=qe(),se=Ie(),S=w(""),h=w(e.value.originalValue.toString()),R=w(!1),ue=w(0),oe=P(()=>{var n;return((n=O().getWarningTexts)==null?void 0:n.requiredMsg)||""}),le=P(()=>{if(R.value)return h.value;const t=S.value.toString();let n=t;if(e.value.enabledCurrencySettings||e.value.fieldCurrency){const l=v.getCurrencyOptions(e.value),g=(l==null?void 0:l.decimalSeparator)||".";g!=="."&&n.includes(".")&&(n=n.replace(".",g))}h.value=n;const r=e.value.round?Math.round(+t):+t;return X(r.toString())}),j=P(()=>{var p;const t=e.value.pricingStructure;if(!t||t==="no_discounts")return"";const n=e.value.pricingRanges||[];if(!n.length)return"";const r=Number(h.value)||0;if(r<=0)return"";const l=Math.max(...n.map(i=>Number(i.unitPrice)||0),Number(e.value.unit)||0),g=l*r;let c=0;if(t==="tiered_discounts"){const i=n.find(a=>{const d=Number(a.minQty)||0,C=Number(a.maxQty)||0;return r>=d&&r<=C});c=(Number((i==null?void 0:i.unitPrice)??e.value.unit)||0)*r}else if(t==="cumulative_discounts"){const i=[...n].sort((a,d)=>(Number(a.minQty)||0)-(Number(d.minQty)||0));let u=r;for(const a of i){const d=Number(a.minQty),C=Number.isFinite(d)?d:0,Q=Math.max(1,C),F=Number(a.maxQty),$=Number.isFinite(F)&&F>0?F:1/0,M=isFinite($)?Math.max(0,$-Q+1):u,V=Math.max(0,Math.min(u,M));if(V>0&&(c+=V*(Number(a.unitPrice)||0),u-=V),u<=0)break}u>0&&(c+=u*l)}else if(t==="flat_rate_discounts"){const i=n.find(a=>{const d=Number(a.minQty)||0,C=Number(a.maxQty)||0;return r>=d&&r<=C});c=Number((i==null?void 0:i.unitPrice)??e.value.unit)||0}let f=0,s=0;if(t==="flat_rate_discounts"){const i=n.find(a=>{const d=Number(a.minQty)||0,C=Number(a.maxQty)||0;return r>=d&&r<=C}),u=Number((i==null?void 0:i.unitPrice)??e.value.unit)||0;f=Math.max(0,l-u),s=l>0?Math.round(f/l*100):0}else f=Math.max(0,g-c),s=g>0?Math.round(f/g*100):0;if(f<=0)return"";const m=v.getCurrencyOptions(e.value),y=v.formatCurrency(f,m),b=((p=e.value)==null?void 0:p.badgeFormat)||"$";return b==="symbol"?`${y}`:b==="percent"?`${s}%`:b==="symbol_and_percent"?`${y} (${s}%)`:""}),ce=P(()=>{if(e.value.styles.style==="default")return Y(()=>Z(()=>import("./Default-tjCcIr5f.js"),[],import.meta.url));if(e.value.styles.style==="buttons")return Y(()=>Z(()=>import("./Buttons-ilx03jeU.js"),__vite__mapDeps([0]),import.meta.url))}),z=(t=!1,n,r,l)=>{if(r&&r!==e.value.alias)return;const g=n.toString();if((!r||l)&&(S.value=g),!R.value&&(!r||l)){const s=v.getCurrencyOptions(e.value);let m=g;const y=s==null?void 0:s.decimalSeparator;(e.value.enabledCurrencySettings||e.value.fieldCurrency)&&y&&y!=="."&&m.includes(".")&&(m=m.replace(".",y)),h.value=m}ye(),t&&typeof n<"u"?(e.value.value=n,e.value.originalValue=n):r||(e.value.originalValue=n);const c=e.value.pricingStructure,f=e.value.pricingRanges||[];if(!e.value.multiply&&c&&c!=="no_discounts"&&Array.isArray(f)&&f.length>0){const s=Number(e.value.originalValue)||0;let m=0,y=[];const b=v.getCurrencyOptions(e.value);if(c==="tiered_discounts"){const p=f.find(u=>{const a=Number(u.minQty)||0,d=Number(u.maxQty)||0;return s>=a&&s<=d}),i=Number((p==null?void 0:p.unitPrice)??e.value.unit)||0;if(m=s*i,s>0){const u=A.parseCommonFieldSign(s.toString(),e.value.sign,e.value.unitPosition),a=v.formatCurrency(i,b);y.push(`${u} x ${a}`)}}else if(c==="cumulative_discounts"){const p=[...f].sort((u,a)=>(Number(u.minQty)||0)-(Number(a.minQty)||0));let i=s;for(const u of p){const a=Number(u.minQty),d=Number.isFinite(a)?a:0,C=Math.max(1,d),Q=Number(u.maxQty),F=Number.isFinite(Q)&&Q>0?Q:1/0,$=isFinite(F)?Math.max(0,F-C+1):i,M=Math.max(0,Math.min(i,$));if(M>0){const V=Number(u.unitPrice)||0;m+=M*V;const E=A.parseCommonFieldSign(M.toString(),e.value.sign,e.value.unitPosition),he=v.formatCurrency(V,b);y.push(`${E} x ${he}`),i-=M}if(i<=0)break}if(i>0){const u=Number(e.value.unit)||0;m+=i*u;const a=A.parseCommonFieldSign(i.toString(),e.value.sign,e.value.unitPosition),d=v.formatCurrency(u,b);y.push(`${a} x ${d}`)}}else if(c==="flat_rate_discounts")if(s>0){const p=f.find(i=>{const u=Number(i.minQty)||0,a=Number(i.maxQty)||0;return s>=u&&s<=a});if(p){const i=Number((p==null?void 0:p.unitPrice)??e.value.unit)||0;m=i;const u=A.parseCommonFieldSign(s.toString(),e.value.sign,e.value.unitPosition),a=v.formatCurrency(i,b);y.push(`${u} â†’ ${a}`)}else m=0}else m=0;e.value.value=e.value.round?Math.round(m):m,e.value.displayValue=v.formatCurrency(e.value.value||0,b),e.value.extraDisplayView=s>0&&y.length?y.join(" + "):""}else e.value.multiply&&e.value.originalValue*e.value.unit!==e.value.value&&(e.value.value=e.value.value*e.value.unit),e.value.displayValue=A.getCommonFieldDisplayView(e.value,h.value);B.updateField(e.value.alias,e.value,l),ae.applyConditionForField(e.value.alias),B.getPageBreakEnabled&&B.getActivePage.action==="not_skip"&&se.checkPageFieldsConditions()},de=t=>{const n=t.target;R.value&&K(n.value)},me=()=>{Number(S.value)<e.value.max&&(S.value=(Number(S.value)+Number(e.value.step)).toString()),K(S.value)},fe=()=>{Number(S.value)>e.value.min&&(S.value=(Number(S.value)-Number(e.value.step)).toString()),K(S.value)},K=t=>{h.value=t;const n=v.getCurrencyOptions(e.value),r=v.parseCurrency(t.toString(),n);isNaN(r)||(z(!0,r),S.value=r.toString())},pe=t=>{const n=t.target;R.value=!0,h.value=_e(n.value||"0")},ge=()=>{R.value=!1},ve=()=>{const t=X(S.value);h.value=t},ye=()=>{const t=v.parseCurrency(h.value.toString(),v.getCurrencyOptions(e.value));if(isNaN(t)){D.value="required";return}const n=t<+e.value.min,r=t>+e.value.max;n||r?D.value="value_range":D.value="required"},be=P(()=>{let t=0;if(ne(e.value.defaultValue.toString())||ne(e.value.step.toString())){let n=e.value.defaultValue.toString().split(".")[1]?e.value.defaultValue.toString().split(".")[1].length:0,r=e.value.step.toString().split(".")[1]?e.value.step.toString().split(".")[1].length:0;t=Math.max(n,r)}return t}),J=(t,n)=>{const r=Math.pow(10,n);return Math.floor(t*r)/r},X=t=>{var f,s,m,y,b,p,i,u,a;if(typeof t=="number"&&t<0&&(t=0),t=t.toString().replace(",","."),!e.value.enabledCurrencySettings&&!e.value.fieldCurrency){const d=parseFloat(t);return J(d,be.value).toString()}(isNaN(Number(t.replace(/,/g,".")))||t.length===0)&&(t="0");let n=parseFloat(t.replace(/,/g,"."));const r=O();let l=((f=r.getCurrencySettings)==null?void 0:f.numAfterInteger)||0,g=((s=r.getCurrencySettings)==null?void 0:s.decimalSeparator)||".",c=((m=r.getCurrencySettings)==null?void 0:m.thousandsSeparator)||",";if(e.value.fieldCurrency&&(l=((b=(y=e.value)==null?void 0:y.fieldCurrencySettings)==null?void 0:b.numAfterInteger)||0,g=((i=(p=e.value)==null?void 0:p.fieldCurrencySettings)==null?void 0:i.decimalSeparator)||".",c=((a=(u=e.value)==null?void 0:u.fieldCurrencySettings)==null?void 0:a.thousandsSeparator)||","),l>0){n=J(n,parseInt(l.toString())),t=n.toFixed(l),t=t.toString().replace(".",g);const d=t.split(g);d[0]=d[0].replace(/\B(?=(\d{3})+(?!\d))/g,c),t=d.join(g)}else t=n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,c);return t},_e=t=>{var u,a,d,C,Q,F,$,M,V,E;const n=O();let r=((u=n.getCurrencySettings)==null?void 0:u.numAfterInteger)||0,l=((a=n.getCurrencySettings)==null?void 0:a.decimalSeparator)||".",g=((d=n.getCurrencySettings)==null?void 0:d.thousandsSeparator)||",";e.value.fieldCurrency&&(r=((Q=(C=e.value)==null?void 0:C.fieldCurrencySettings)==null?void 0:Q.numAfterInteger)||0,l=(($=(F=e.value)==null?void 0:F.fieldCurrencySettings)==null?void 0:$.decimalSeparator)||".",g=((V=(M=e.value)==null?void 0:M.fieldCurrencySettings)==null?void 0:V.thousandsSeparator)||",");let c;t.includes(".")&&t.includes(",")?c=t.split(l):t.includes(",")?c=t.split(","):t.includes(".")?c=t.split("."):c=[t],c[0]=c[0].split(g).join("");let f=c.join(l);const s=v.getCurrencyOptions(e.value);let m=v.parseCurrency(f,s);if(isNaN(m))return f;const y=(s==null?void 0:s.numAfterInteger)??r??((E=n.getCurrencySettings)==null?void 0:E.numAfterInteger)??0,b=Number(y);Number.isFinite(b)&&b>=0&&(m=Number(m.toFixed(b)));let p=m.toString();const i=(s==null?void 0:s.decimalSeparator)||l;return i&&i!=="."&&p.includes(".")&&(p=p.replace(".",i)),p},Se=t=>{var c,f,s;let r=((c=O().getCurrencySettings)==null?void 0:c.decimalSeparator)||".";e.value.fieldCurrency&&(r=((s=(f=e.value)==null?void 0:f.fieldCurrencySettings)==null?void 0:s.decimalSeparator)||".");let l=t.keyCode?t.keyCode:t.which,g=46;r===","&&(g=44),(l<48||l>57)&&l!==g&&t.preventDefault()},L=P(()=>{const t=v.parseCurrency(h.value.toString(),v.getCurrencyOptions(e.value));if(!isNaN(t)){const n=t<e.value.min,r=t>e.value.max;if(n||r)return!0}return B.checkFieldRequired(e.value)}),xe=P(()=>`
    ${T.getTranslations.valueMustBeBetween} ${e.value.min} ${T.getTranslations.and} ${e.value.max}
  `);return ie.add("updateQuantity",z),ke(()=>{h.value=e.value.originalValue.toString(),S.value=h.value,z(!1,e.value.originalValue,void 0,!0)}),(t,n)=>(_(),N("div",{class:ee(["ccb-field ccb-field-quantity",{required:L.value,"ccb-field-disabled":o(e).disabled,[o(e).additionalStyles||""]:!!o(e).additionalStyles,"has-badge":!!j.value}])},[q("div",Re,[L.value?(_(),N("div",we,[D.value==="value_range"?(_(),W(te,{key:0,field:o(e),text:xe.value},null,8,["field","text"])):(_(),W(te,{key:1,field:o(e),text:oe.value},null,8,["field","text"]))])):k("",!0),q("div",De,[q("span",{id:H.value},x(o(e).label),9,Be),o(e).required?(_(),N("span",Ee,"*")):k("",!0)])]),o(G).getAppearanceDescriptionPosition==="before"?(_(),N("div",Oe,[o(e).hideMinMax?k("",!0):(_(),N("div",Ue,x(o(T).getTranslations.min)+": "+x(o(e).min)+" - "+x(o(T).getTranslations.max)+": "+x(o(e).max),1)),o(e).description?(_(),N("div",je,x(o(e).description),1)):k("",!0)])):k("",!0),(_(),W(Fe(ce.value),{field:o(e),value:le.value,"input-id":re.value,"aria-labelledby":H.value,onInput:de,onFocus:pe,onFocusout:ve,onBlur:ge,onKeypress:Se,key:ue.value,onIncrement:me,onDecrement:fe},null,40,["field","value","input-id","aria-labelledby"])),o(G).getAppearanceDescriptionPosition==="after"?(_(),N("div",ze,[o(e).hideMinMax?k("",!0):(_(),N("div",Ke,x(o(T).getTranslations.min)+": "+x(o(e).min)+" - "+x(o(T).getTranslations.max)+": "+x(o(e).max),1)),o(e).description?(_(),N("div",Le,x(o(e).description),1)):k("",!0)])):k("",!0),j.value&&!o(e).multiply&&!L.value?(_(),N("div",{key:2,class:ee(["ccb-field__badge",o(e).badgeVariant])},[q("div",We,[o(e).badgeVariant==="primary"?(_(),N("i",He)):k("",!0),q("div",Ge,x(o(e).badgeText)+":",1),q("div",Je,x(j.value),1)])],2)):k("",!0)],2))}}),at=Ae(Xe,[["__scopeId","data-v-c8ae0c99"]]);export{at as default};
//# sourceMappingURL=index-CDLBNSWz.js.map
