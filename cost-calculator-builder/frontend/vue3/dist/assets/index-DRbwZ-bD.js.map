{"version":3,"file":"index-DRbwZ-bD.js","sources":["../../src/widget/features/calculator-fields/components/Dropdown/Dropdown.vue"],"sourcesContent":["<template>\n  <div\n    class=\"ccb-field ccb-dropdown-field\"\n    :class=\"{\n      active: isBodyVisible,\n      required: isRequired,\n      'ccb-field-disabled': field.disabled,\n      [additionalClasses]: true,\n    }\"\n  >\n    <div class=\"ccb-field__label\">\n      <RequiredHint\n        v-if=\"isRequired\"\n        :text=\"translationsStore.getTranslations.requiredField\"\n      />\n      <div class=\"ccb-field__title\">\n        {{ field.label\n        }}<span v-if=\"field.required\" class=\"ccb-field-required-mark\">*</span>\n      </div>\n    </div>\n\n    <div\n      v-if=\"appearanceStore.getAppearanceDescriptionPosition === 'before'\"\n      class=\"ccb-field__descriptions ccb-before\"\n    >\n      <div v-if=\"field.description\" class=\"ccb-field__description\">\n        {{ field.description }}\n      </div>\n    </div>\n\n    <div class=\"ccb-field__input-wrapper\" ref=\"dropdownWrapper\">\n      <div class=\"ccb-dropdown\">\n        <div class=\"ccb-dropdown__input\" @click=\"toggleBody\">\n          <span v-if=\"!selectedValue\" class=\"ccb-dropdown__label\">\n            {{ translationsStore.getTranslations.selectValue }}\n          </span>\n          <span v-else class=\"ccb-dropdown__label\">\n            {{ selectedValue.optionText }}\n          </span>\n          <span class=\"ccb-dropdown__icon\">\n            <i class=\"ccb-icon-Path-3485\"></i>\n          </span>\n        </div>\n        <div class=\"ccb-dropdown__list\">\n          <ul>\n            <li @click.prevent=\"() => selectValue(undefined, true)\">\n              {{ translationsStore.getTranslations.selectValue }}\n            </li>\n            <li\n              v-for=\"(option, idx) in fieldOptions\"\n              :key=\"option.optionValue\"\n              @click.prevent=\"() => selectValue(option)\"\n              class=\"ccb-dropdown--option\"\n              :class=\"{\n                'ccb-option-disabled': field.disableOptions.includes(idx),\n              }\"\n            >\n              <span class=\"ccb-dropdown--option-label\">\n                {{ option.optionText }}\n              </span>\n              <span\n                class=\"ccb-dropdown--option-converted\"\n                v-if=\"field.showValueInOption\"\n              >\n                {{ translationsStore.getTranslations.price }}:\n                {{ option.optionConverted }}\n              </span>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <div\n      v-if=\"appearanceStore.getAppearanceDescriptionPosition === 'after'\"\n      class=\"ccb-field__descriptions ccb-after\"\n    >\n      <div v-if=\"field.description\" class=\"ccb-field__description\">\n        {{ field.description }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { toRefs, ref, computed } from \"vue\";\nimport { IOptions, ISingleOptionsField } from \"@/widget/shared/types/fields\";\nimport { useFieldsStore } from \"@/widget/app/providers/stores/fieldsStore.ts\";\nimport { useSingleField } from \"@/widget/actions/fields/composable/useSingleField.ts\";\nimport { useAppearanceStore } from \"@/widget/app/providers/stores/appearanceStore.ts\";\nimport { useConditionsStore } from \"@/widget/app/providers/stores/conditionsStore.ts\";\nimport RequiredHint from \"@/widget/shared/ui/components/Required-hint/RequiredHint.vue\";\nimport { useTranslationsStore } from \"@/widget/app/providers/stores/translationsStore\";\nimport { useFields } from \"@/widget/actions/fields/composable/useFields.ts\";\nimport { usePageConditions } from \"@/widget/actions/conditions/composable/usePageConditions.ts\";\n\nconst fieldsInstance = useFields();\nconst pageConditions = usePageConditions();\n\ntype Props = {\n  field: ISingleOptionsField;\n};\n\nconst props = defineProps<Props>();\nconst { field } = toRefs(props);\n\nconst fieldStore = useFieldsStore();\nconst singleFieldInstance = useSingleField();\nconst appearanceStore = useAppearanceStore();\nconst conditionsStore = useConditionsStore();\nconst translationsStore = useTranslationsStore();\n\nconst isBodyVisible = ref<boolean>(false);\n\nconst dropdownWrapper = ref<HTMLElement | null>(null);\n\nconst toggleBody = () => {\n  if (!isBodyVisible.value) {\n    document.addEventListener(\"click\", handleClickOutside);\n  } else {\n    document.removeEventListener(\"click\", handleClickOutside);\n  }\n  isBodyVisible.value = !isBodyVisible.value;\n};\n\nconst handleClickOutside = (event: MouseEvent) => {\n  if (\n    dropdownWrapper.value &&\n    \"contains\" in dropdownWrapper.value &&\n    !dropdownWrapper.value.contains(event.target as Node)\n  ) {\n    isBodyVisible.value = false;\n    document.removeEventListener(\"click\", handleClickOutside);\n  }\n};\n\nconst selectValue = (option: IOptions | undefined, toggle: boolean = true) => {\n  if (option?.optionValue !== selectedValue.value?.optionValue) {\n    let value: number = 0;\n\n    if (\n      option?.optionValue &&\n      field.value.summaryView !== \"show_label_not_calculable\"\n    ) {\n      const optionValue: string = option?.optionValue;\n      value = +optionValue.split(\"_\")[0] || 0;\n    }\n\n    field.value.selectedOption = option;\n    field.value.value = value;\n\n    field.value.displayValue =\n      singleFieldInstance.getMultipleOptionsFieldDisplayView(\n        field.value,\n      ) as string;\n\n    fieldStore.updateField(field.value.alias, field.value);\n    conditionsStore.applyConditionForField(field.value.alias);\n\n    if (\n      fieldsInstance.getPageBreakEnabled() &&\n      fieldsInstance.getActivePage().action === \"not_skip\"\n    ) {\n      pageConditions.checkPageFieldsConditions();\n    }\n  }\n\n  if (toggle) {\n    toggleBody();\n  }\n};\n\nconst selectedValue = computed(() => field.value.selectedOption);\n\nconst fieldOptions = computed(() => {\n  return field.value.options?.map((f: IOptions) => {\n    return {\n      ...f,\n    };\n  });\n});\n\nconst isRequired = computed(() => {\n  return fieldStore.checkFieldRequired(field.value);\n});\n\nconst additionalClasses = computed(() => {\n  return field.value?.additionalStyles || \"\";\n});\n</script>\n\n<style lang=\"scss\" scoped>\n@use \"@/styles/widget/_mixins.scss\" as mixins;\n\n.ccb-dropdown {\n  position: relative;\n  &--option-converted {\n    font-size: calc(var(--ccb-summary-text-size) - 2px);\n    color: var(--ccb-text-color);\n\n    @media only screen and (max-width: 480px) {\n      font-size: calc(var(--ccb-mobile-summary-text-size) - 2px);\n    }\n  }\n\n  &__input {\n    @include mixins.field;\n  }\n\n  &__input {\n    padding-right: 10px;\n\n    display: grid;\n    grid-template-columns: 1fr auto;\n    justify-content: space-between;\n    cursor: pointer;\n\n    @media only screen and (max-width: 480px) {\n      padding: 12px var(--ccb-mobile-field-side-indent);\n      min-height: var(--ccb-mobile-field-button-height);\n    }\n  }\n\n  &__icon {\n    font-size: 8px;\n    display: grid;\n    place-items: center;\n    transition: 300ms ease;\n  }\n\n  &__list {\n    margin-top: 5px;\n    border-radius: 4px;\n    background: #ffffff;\n    border-color: transparent;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);\n    max-height: 261px;\n    position: absolute;\n    top: 25px;\n    left: 0;\n    width: 100%;\n    z-index: 100;\n    visibility: hidden;\n    opacity: 0;\n    transition: 200ms ease;\n    overflow-y: auto;\n\n    ul {\n      list-style: none;\n      padding: 0;\n      margin: 0;\n      background: var(--ccb-fields-bg-color);\n\n      li {\n        display: flex;\n        flex-direction: column;\n        align-items: flex-start !important;\n        row-gap: 0px;\n        padding: 10px 18px !important;\n        margin: 0;\n        background: var(--ccb-fields-bg-color);\n        color: var(--ccb-text-color);\n\n        border-bottom: 1px solid var(--ccb-fields-border-color);\n        cursor: pointer;\n        font-size: 15px;\n        font-weight: var(--ccb-field-weight);\n\n        .ccb-dropdown--option-label {\n          font-size: 14px;\n          font-weight: 500;\n        }\n\n        .ccb-dropdown--option-converted {\n          font-size: 12px;\n          font-weight: 400;\n        }\n\n        &:hover {\n          background: var(--ccb-fields-hover-color) !important;\n        }\n\n        @media only screen and (max-width: 480px) {\n          font-weight: var(--ccb-mobile-field-weight);\n        }\n      }\n    }\n  }\n}\n\n.ccb-dropdown-field {\n  &.active {\n    .ccb-dropdown__input {\n      border-color: var(--ccb-accent-color);\n    }\n    .ccb-dropdown__list {\n      visibility: visible;\n      opacity: 1;\n      top: 45px;\n      z-index: 9999;\n    }\n\n    .ccb-dropdown__icon {\n      transform: rotate(180deg);\n    }\n  }\n}\n</style>\n"],"names":["fieldsInstance","useFields","pageConditions","usePageConditions","props","__props","field","toRefs","fieldStore","useFieldsStore","singleFieldInstance","useSingleField","appearanceStore","useAppearanceStore","conditionsStore","useConditionsStore","translationsStore","useTranslationsStore","isBodyVisible","ref","dropdownWrapper","toggleBody","handleClickOutside","event","selectValue","option","toggle","_a","selectedValue","value","computed","fieldOptions","f","isRequired","additionalClasses"],"mappings":"ohCAgGA,MAAMA,EAAiBC,EAAU,EAC3BC,EAAiBC,EAAkB,EAMnCC,EAAQC,EACR,CAAE,MAAAC,CAAA,EAAUC,EAAOH,CAAK,EAExBI,EAAaC,EAAe,EAC5BC,EAAsBC,EAAe,EACrCC,EAAkBC,EAAmB,EACrCC,EAAkBC,EAAmB,EACrCC,EAAoBC,EAAqB,EAEzCC,EAAgBC,EAAa,EAAK,EAElCC,EAAkBD,EAAwB,IAAI,EAE9CE,EAAa,IAAM,CAClBH,EAAc,MAGR,SAAA,oBAAoB,QAASI,CAAkB,EAF/C,SAAA,iBAAiB,QAASA,CAAkB,EAIzCJ,EAAA,MAAQ,CAACA,EAAc,KACvC,EAEMI,EAAsBC,GAAsB,CAE9CH,EAAgB,OAChB,aAAcA,EAAgB,OAC9B,CAACA,EAAgB,MAAM,SAASG,EAAM,MAAc,IAEpDL,EAAc,MAAQ,GACb,SAAA,oBAAoB,QAASI,CAAkB,EAE5D,EAEME,EAAc,CAACC,EAA8BC,EAAkB,KAAS,OAC5E,IAAID,GAAA,YAAAA,EAAQ,iBAAgBE,EAAAC,EAAc,QAAd,YAAAD,EAAqB,aAAa,CAC5D,IAAIE,EAAgB,EAGlBJ,GAAA,MAAAA,EAAQ,aACRnB,EAAM,MAAM,cAAgB,8BAG5BuB,EAAQ,EADoBJ,GAAA,YAAAA,EAAQ,aACf,MAAM,GAAG,EAAE,CAAC,GAAK,GAGxCnB,EAAM,MAAM,eAAiBmB,EAC7BnB,EAAM,MAAM,MAAQuB,EAEdvB,EAAA,MAAM,aACVI,EAAoB,mCAClBJ,EAAM,KACR,EAEFE,EAAW,YAAYF,EAAM,MAAM,MAAOA,EAAM,KAAK,EACrCQ,EAAA,uBAAuBR,EAAM,MAAM,KAAK,EAGtDN,EAAe,uBACfA,EAAe,cAAc,EAAE,SAAW,YAE1CE,EAAe,0BAA0B,CAC3C,CAGEwB,GACSL,EAAA,CAEf,EAEMO,EAAgBE,EAAS,IAAMxB,EAAM,MAAM,cAAc,EAEzDyB,EAAeD,EAAS,IAAM,OAClC,OAAOH,EAAArB,EAAM,MAAM,UAAZ,YAAAqB,EAAqB,IAAKK,IACxB,CACL,GAAGA,CACL,GACD,CACF,EAEKC,EAAaH,EAAS,IACnBtB,EAAW,mBAAmBF,EAAM,KAAK,CACjD,EAEK4B,EAAoBJ,EAAS,IAAM,OAChC,QAAAH,EAAArB,EAAM,QAAN,YAAAqB,EAAa,mBAAoB,EAAA,CACzC"}