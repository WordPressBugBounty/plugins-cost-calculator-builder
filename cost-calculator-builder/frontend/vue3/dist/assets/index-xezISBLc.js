const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Buttons-CJldvQ5_.css"])))=>i.map(i=>d[i]);
import{a as Ce,C as Ne,k as R,b as F,e as X,_ as Y,o as ke,m as N,g as _,p as $,q as k,f as W,u as o,D as x,r as Fe,I as Z}from"./convert-case-to-camel-case.utils-DRsbC-qG.js";import{m as Me,u as Ve,c as Pe,n as Qe,d as Ie,a as E,l as $e,o as Te}from"./widget-DTyF7X6W.js";import{_ as ee}from"./RequiredHint.vue_vue_type_style_index_0_lang-DFYyucnB.js";import{u as qe}from"./translationsStore-C34buciO.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const te=M=>{if(M===void 0||(M==null?void 0:M.length)<0)return!1;const O=/^[-+]?[0-9]+\.[0-9]+$/;return!!M.toString().match(O)},Re={class:"ccb-field__label"},we={key:0,class:"ccb-required-tooltip"},De={class:"ccb-field__title"},Be=["id"],Ee={key:0,class:"ccb-field-required-mark"},Oe={key:0,class:"ccb-field__descriptions ccb-before"},Ue={key:0,class:"ccb-field__description"},je={key:1,class:"ccb-field__description"},Ke={key:1,class:"ccb-field__descriptions ccb-after"},Le={key:0,class:"ccb-field__description"},We={key:1,class:"ccb-field__description"},ze={class:"ccb-field__badge-content"},He={key:0,class:"ccb-icon-price-tag"},Ge={class:"ccb-field__badge-text"},Je={class:"ccb-field__badge-value"},Xe=Ce({__name:"Quantity",props:{field:{}},setup(M){const O=M,{field:e}=Ne(O),w=R("required"),ne=F(()=>`ccb_quantity_${e.value.alias}`),z=F(()=>`ccb_label_${e.value.alias}`),re=Me(),y=$e(),H=Ve(),D=Pe(),ae=Qe(),T=Te(),V=qe(),ie=Ie(),S=R(""),h=R(e.value.originalValue.toString()),q=R(!1),se=R(0),ue=F(()=>{var n;return((n=E().getWarningTexts)==null?void 0:n.requiredMsg)||""}),oe=F(()=>{if(q.value)return h.value;const t=S.value.toString();let n=t;if(e.value.enabledCurrencySettings||e.value.fieldCurrency){const l=y.getCurrencyOptions(e.value),c=(l==null?void 0:l.decimalSeparator)||".";c!=="."&&n.includes(".")&&(n=n.replace(".",c))}h.value=n;const r=e.value.round?Math.round(+t):+t;return J(r.toString())}),U=F(()=>{var v;const t=e.value.pricingStructure;if(!t||t==="no_discounts")return"";const n=e.value.pricingRanges||[];if(!n.length)return"";const r=Number(h.value)||0;if(r<=0)return"";const l=Math.max(...n.map(a=>Number(a.unitPrice)||0),Number(e.value.unit)||0),c=l*r;let m=0;if(t==="tiered_discounts"){const a=n.find(i=>{const d=Number(i.minQty)||0,C=Number(i.maxQty)||0;return r>=d&&r<=C});m=(Number((a==null?void 0:a.unitPrice)??e.value.unit)||0)*r}else if(t==="cumulative_discounts"){const a=[...n].sort((i,d)=>(Number(i.minQty)||0)-(Number(d.minQty)||0));let s=r;for(const i of a){const d=Number(i.minQty),C=Number.isFinite(d)?d:0,A=Math.max(1,C),P=Number(i.maxQty),B=Number.isFinite(P)&&P>0?P:1/0,Q=isFinite(B)?Math.max(0,B-A+1):s,I=Math.max(0,Math.min(s,Q));if(I>0&&(m+=I*(Number(i.unitPrice)||0),s-=I),s<=0)break}s>0&&(m+=s*l)}else if(t==="flat_rate_discounts"){const a=n.find(i=>{const d=Number(i.minQty)||0,C=Number(i.maxQty)||0;return r>=d&&r<=C});m=Number((a==null?void 0:a.unitPrice)??e.value.unit)||0}let g=0,u=0;if(t==="flat_rate_discounts"){const a=n.find(i=>{const d=Number(i.minQty)||0,C=Number(i.maxQty)||0;return r>=d&&r<=C}),s=Number((a==null?void 0:a.unitPrice)??e.value.unit)||0;g=Math.max(0,l-s),u=l>0?Math.round(g/l*100):0}else g=Math.max(0,c-m),u=c>0?Math.round(g/c*100):0;if(g<=0)return"";const f=y.getCurrencyOptions(e.value),p=y.formatCurrency(g,f),b=((v=e.value)==null?void 0:v.badgeFormat)||"$";return b==="symbol"?`${p}`:b==="percent"?`${u}%`:b==="symbol_and_percent"?`${p} (${u}%)`:""}),le=F(()=>{if(e.value.styles.style==="default")return X(()=>Y(()=>import("./Default-tjCcIr5f.js"),[],import.meta.url));if(e.value.styles.style==="buttons")return X(()=>Y(()=>import("./Buttons-ilx03jeU.js"),__vite__mapDeps([0]),import.meta.url))}),j=(t=!1,n,r,l)=>{if(r&&r!==e.value.alias)return;const c=n.toString();if((!r||l)&&(S.value=c),!q.value&&(!r||l)){const u=y.getCurrencyOptions(e.value);let f=c;const p=u==null?void 0:u.decimalSeparator;(e.value.enabledCurrencySettings||e.value.fieldCurrency)&&p&&p!=="."&&f.includes(".")&&(f=f.replace(".",p)),h.value=f}ve(),t&&typeof n<"u"?(e.value.value=n,e.value.originalValue=n):r||(e.value.originalValue=n);const m=e.value.pricingStructure,g=e.value.pricingRanges||[];if(!e.value.multiply&&m&&m!=="no_discounts"&&Array.isArray(g)&&g.length>0){const u=Number(e.value.originalValue)||0;let f=0,p=[];const b=y.getCurrencyOptions(e.value);if(m==="tiered_discounts"){const v=g.find(s=>{const i=Number(s.minQty)||0,d=Number(s.maxQty)||0;return u>=i&&u<=d}),a=Number((v==null?void 0:v.unitPrice)??e.value.unit)||0;if(f=u*a,u>0){const s=T.parseCommonFieldSign(u.toString(),e.value.sign,e.value.unitPosition),i=y.formatCurrency(a,b);p.push(`${s} x ${i}`)}}else if(m==="cumulative_discounts"){const v=[...g].sort((s,i)=>(Number(s.minQty)||0)-(Number(i.minQty)||0));let a=u;for(const s of v){const i=Number(s.minQty),d=Number.isFinite(i)?i:0,C=Math.max(1,d),A=Number(s.maxQty),P=Number.isFinite(A)&&A>0?A:1/0,B=isFinite(P)?Math.max(0,P-C+1):a,Q=Math.max(0,Math.min(a,B));if(Q>0){const I=Number(s.unitPrice)||0;f+=Q*I;const xe=T.parseCommonFieldSign(Q.toString(),e.value.sign,e.value.unitPosition),he=y.formatCurrency(I,b);p.push(`${xe} x ${he}`),a-=Q}if(a<=0)break}if(a>0){const s=Number(e.value.unit)||0;f+=a*s;const i=T.parseCommonFieldSign(a.toString(),e.value.sign,e.value.unitPosition),d=y.formatCurrency(s,b);p.push(`${i} x ${d}`)}}else if(m==="flat_rate_discounts")if(u>0){const v=g.find(a=>{const s=Number(a.minQty)||0,i=Number(a.maxQty)||0;return u>=s&&u<=i});if(v){const a=Number((v==null?void 0:v.unitPrice)??e.value.unit)||0;f=a;const s=T.parseCommonFieldSign(u.toString(),e.value.sign,e.value.unitPosition),i=y.formatCurrency(a,b);p.push(`${s} â†’ ${i}`)}else f=0}else f=0;e.value.value=e.value.round?Math.round(f):f,e.value.displayValue=y.formatCurrency(e.value.value||0,b),e.value.extraDisplayView=u>0&&p.length?p.join(" + "):""}else e.value.multiply&&e.value.originalValue*e.value.unit!==e.value.value&&(e.value.value=e.value.value*e.value.unit),e.value.displayValue=T.getCommonFieldDisplayView(e.value,h.value);D.updateField(e.value.alias,e.value,l),ae.applyConditionForField(e.value.alias),D.getPageBreakEnabled&&D.getActivePage.action==="not_skip"&&ie.checkPageFieldsConditions()},ce=t=>{const n=t.target;q.value&&K(n.value)},de=()=>{Number(S.value)<e.value.max&&(S.value=(Number(S.value)+Number(e.value.step)).toString()),K(S.value)},me=()=>{Number(S.value)>e.value.min&&(S.value=(Number(S.value)-Number(e.value.step)).toString()),K(S.value)},K=t=>{h.value=t;const n=y.getCurrencyOptions(e.value),r=y.parseCurrency(t.toString(),n);isNaN(r)||(j(!0,r),S.value=r.toString())},fe=t=>{const n=t.target;q.value=!0,h.value=be(n.value||"0")},ge=()=>{q.value=!1},pe=()=>{const t=J(S.value);h.value=t},ve=()=>{const t=y.parseCurrency(h.value.toString(),y.getCurrencyOptions(e.value));if(isNaN(t)){w.value="required";return}const n=t<+e.value.min,r=t>+e.value.max;n||r?w.value="value_range":w.value="required"},ye=F(()=>{let t=0;if(te(e.value.defaultValue.toString())||te(e.value.step.toString())){let n=e.value.defaultValue.toString().split(".")[1]?e.value.defaultValue.toString().split(".")[1].length:0,r=e.value.step.toString().split(".")[1]?e.value.step.toString().split(".")[1].length:0;t=Math.max(n,r)}return t}),G=(t,n)=>{const r=Math.pow(10,n);return Math.floor(t*r)/r},J=t=>{var g,u,f,p,b,v,a,s,i;if(typeof t=="number"&&t<0&&(t=0),t=t.toString().replace(",","."),!e.value.enabledCurrencySettings&&!e.value.fieldCurrency){const d=parseFloat(t);return G(d,ye.value).toString()}(isNaN(Number(t.replace(/,/g,".")))||t.length===0)&&(t="0");let n=parseFloat(t.replace(/,/g,"."));const r=E();let l=((g=r.getCurrencySettings)==null?void 0:g.numAfterInteger)||0,c=((u=r.getCurrencySettings)==null?void 0:u.decimalSeparator)||".",m=((f=r.getCurrencySettings)==null?void 0:f.thousandsSeparator)||",";if(e.value.fieldCurrency&&(l=((b=(p=e.value)==null?void 0:p.fieldCurrencySettings)==null?void 0:b.numAfterInteger)||0,c=((a=(v=e.value)==null?void 0:v.fieldCurrencySettings)==null?void 0:a.decimalSeparator)||".",m=((i=(s=e.value)==null?void 0:s.fieldCurrencySettings)==null?void 0:i.thousandsSeparator)||","),l>0){n=G(n,parseInt(l.toString())),t=n.toFixed(l),t=t.toString().replace(".",c);const d=t.split(c);d[0]=d[0].replace(/\B(?=(\d{3})+(?!\d))/g,m),t=d.join(c)}else t=n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,m);return t},be=t=>{var b,v,a,s,i,d,C;const n=E();let r=((b=n.getCurrencySettings)==null?void 0:b.numAfterInteger)||0,l=((v=n.getCurrencySettings)==null?void 0:v.decimalSeparator)||".";e.value.fieldCurrency&&(r=((s=(a=e.value)==null?void 0:a.fieldCurrencySettings)==null?void 0:s.numAfterInteger)||0,l=((d=(i=e.value)==null?void 0:i.fieldCurrencySettings)==null?void 0:d.decimalSeparator)||".");const c=y.getCurrencyOptions(e.value);let m=y.parseCurrency(t,c);if(isNaN(m))return t;const g=(c==null?void 0:c.numAfterInteger)??r??((C=n.getCurrencySettings)==null?void 0:C.numAfterInteger)??0,u=Number(g);Number.isFinite(u)&&u>=0&&(m=Number(m.toFixed(u)));let f=m.toString();const p=(c==null?void 0:c.decimalSeparator)||l;return p&&p!=="."&&f.includes(".")&&(f=f.replace(".",p)),f},_e=t=>{var m,g,u;let r=((m=E().getCurrencySettings)==null?void 0:m.decimalSeparator)||".";e.value.fieldCurrency&&(r=((u=(g=e.value)==null?void 0:g.fieldCurrencySettings)==null?void 0:u.decimalSeparator)||".");let l=t.keyCode?t.keyCode:t.which,c=46;r===","&&(c=44),(l<48||l>57)&&l!==c&&t.preventDefault()},L=F(()=>{const t=y.parseCurrency(h.value.toString(),y.getCurrencyOptions(e.value));if(!isNaN(t)){const n=t<e.value.min,r=t>e.value.max;if(n||r)return!0}return D.checkFieldRequired(e.value)}),Se=F(()=>`
    ${V.getTranslations.valueMustBeBetween} ${e.value.min} ${V.getTranslations.and} ${e.value.max}
  `);return re.add("updateQuantity",j),ke(()=>{h.value=e.value.originalValue.toString(),S.value=h.value,j(!1,e.value.originalValue,void 0,!0)}),(t,n)=>(_(),N("div",{class:Z(["ccb-field ccb-field-quantity",{required:L.value,"ccb-field-disabled":o(e).disabled,[o(e).additionalStyles||""]:!!o(e).additionalStyles,"has-badge":!!U.value}])},[$("div",Re,[L.value?(_(),N("div",we,[w.value==="value_range"?(_(),W(ee,{key:0,field:o(e),text:Se.value},null,8,["field","text"])):(_(),W(ee,{key:1,field:o(e),text:ue.value},null,8,["field","text"]))])):k("",!0),$("div",De,[$("span",{id:z.value},x(o(e).label),9,Be),o(e).required?(_(),N("span",Ee,"*")):k("",!0)])]),o(H).getAppearanceDescriptionPosition==="before"?(_(),N("div",Oe,[o(e).hideMinMax?k("",!0):(_(),N("div",Ue,x(o(V).getTranslations.min)+": "+x(o(e).min)+" - "+x(o(V).getTranslations.max)+": "+x(o(e).max),1)),o(e).description?(_(),N("div",je,x(o(e).description),1)):k("",!0)])):k("",!0),(_(),W(Fe(le.value),{field:o(e),value:oe.value,"input-id":ne.value,"aria-labelledby":z.value,onInput:ce,onFocus:fe,onFocusout:pe,onBlur:ge,onKeypress:_e,key:se.value,onIncrement:de,onDecrement:me},null,40,["field","value","input-id","aria-labelledby"])),o(H).getAppearanceDescriptionPosition==="after"?(_(),N("div",Ke,[o(e).hideMinMax?k("",!0):(_(),N("div",Le,x(o(V).getTranslations.min)+": "+x(o(e).min)+" - "+x(o(V).getTranslations.max)+": "+x(o(e).max),1)),o(e).description?(_(),N("div",We,x(o(e).description),1)):k("",!0)])):k("",!0),U.value&&!o(e).multiply&&!L.value?(_(),N("div",{key:2,class:Z(["ccb-field__badge",o(e).badgeVariant])},[$("div",ze,[o(e).badgeVariant==="primary"?(_(),N("i",He)):k("",!0),$("div",Ge,x(o(e).badgeText)+":",1),$("div",Je,x(U.value),1)])],2)):k("",!0)],2))}}),it=Ae(Xe,[["__scopeId","data-v-542328e0"]]);export{it as default};
//# sourceMappingURL=index-xezISBLc.js.map
