{"version":3,"file":"index-DK1tAbfW.js","sources":["../../src/widget/features/calculator-fields/components/DatePicker/DatePicker.vue"],"sourcesContent":["<template>\n  <div\n    class=\"ccb-field ccb-datePicker\"\n    :class=\"{\n      required: isRequired,\n      'ccb-field-disabled': field.disabled,\n      [additionalClasses]: true,\n    }\"\n  >\n    <div class=\"ccb-field__label\">\n      <RequiredHint\n        v-if=\"isRequired\"\n        :text=\"translationsStore.getTranslations.requiredField\"\n      />\n      <div class=\"ccb-field__title\">\n        {{ field.label\n        }}<span v-if=\"field.required\" class=\"ccb-field-required-mark\">*</span\n        ><ProBadge />\n      </div>\n    </div>\n\n    <div\n      v-if=\"appearanceStore.descriptionPosition === 'before'\"\n      class=\"ccb-field__descriptions ccb-before\"\n    >\n      <div v-if=\"field.description\" class=\"ccb-field__description\">\n        {{ field.description }}\n      </div>\n    </div>\n\n    <div class=\"ccb-field__input-wrapper\">\n      <VueDatePicker\n        v-model=\"date\"\n        :auto-apply=\"field.autoCloseEnabled\"\n        :range=\"field.range\"\n        :placeholder=\"getPlaceholder\"\n        :enable-time-picker=\"false\"\n        :disabled-week-days=\"getDisabledWeekDays\"\n        :disabled-dates=\"getTotalDisableDate\"\n        :min-date=\"getMinDate\"\n        :format=\"format\"\n        @update:model-value=\"updateValue\"\n      />\n    </div>\n\n    <div\n      v-if=\"appearanceStore.descriptionPosition === 'after'\"\n      class=\"ccb-field__descriptions ccb-after\"\n    >\n      <div v-if=\"field.description\" class=\"ccb-field__description\">\n        {{ field.description }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { toRefs, computed } from \"vue\";\nimport { useAppearanceStore } from \"@/widget/app/providers/stores/appearanceStore.ts\";\nimport VueDatePicker from \"@vuepic/vue-datepicker\";\nimport \"@vuepic/vue-datepicker/dist/main.css\";\nimport { IDatePickerField } from \"@/widget/shared/types/fields\";\nimport { useFieldsStore } from \"@/widget/app/providers/stores/fieldsStore.ts\";\nimport { useConditionsStore } from \"@/widget/app/providers/stores/conditionsStore.ts\";\nimport { useSingleField } from \"@/widget/actions/fields/composable/useSingleField.ts\";\nimport { useDatePickerFieldHelper } from \"@/widget/actions/fields/composable/useDatePickerFieldHelper.ts\";\nimport { useCallbackStore } from \"@/widget/app/providers/stores/callbackStore.ts\";\nimport ProBadge from \"@/widget/shared/ui/components/Pro-badge/ProBadge.vue\";\nimport RequiredHint from \"@/widget/shared/ui/components/Required-hint/RequiredHint.vue\";\nimport { useTranslationsStore } from \"@/widget/app/providers/stores/translationsStore\";\ntype Props = {\n  field: IDatePickerField;\n};\n\nconst props = defineProps<Props>();\nconst { field } = toRefs(props);\n\nconst appearanceStore = useAppearanceStore();\nconst fieldStore = useFieldsStore();\nconst conditionsStore = useConditionsStore();\nconst singleFieldMixins = useSingleField();\nconst callbackStore = useCallbackStore();\nconst translationsStore = useTranslationsStore();\n\nconst { parseDate, getDaysDifference, displayValueHelper } =\n  useDatePickerFieldHelper();\n\nconst format = () => displayValueHelper(date.value);\nconst date = computed({\n  get() {\n    return field.value.selectedDate;\n  },\n  set(value) {\n    field.value.selectedDate = value;\n  },\n});\n\nconst isRequired = computed(() => {\n  return fieldStore.checkFieldRequired(field.value);\n});\n\nconst getPlaceholder = computed(() => {\n  return field.value.placeholder ? field.value.placeholder : \"Select Date\";\n});\n\nconst getDisabledWeekDays = computed(() => {\n  if (!field.value.isHaveUnselectable) return [];\n  return field.value.notAllowedWeekDays?.map((n) => (n === 7 ? 0 : n));\n});\n\nconst getDisabledDates = computed(() => {\n  const today = new Date();\n  let days: Date[] = [];\n\n  if (!field.value.isHaveUnselectable) return days;\n\n  for (let i = 1; i <= field.value.daysFromCurrent; i++) {\n    const nDay = new Date(today);\n    nDay.setDate(nDay.getDate() + i);\n    days.push(nDay);\n  }\n\n  if (field.value.notAllowedDates?.current) {\n    days.push(today);\n  }\n\n  return days;\n});\n\nconst getMinDate = computed(() => {\n  if (field.value.isHaveUnselectable && field.value.notAllowedDates?.allPast) {\n    return new Date();\n  }\n\n  return \"\";\n});\n\nconst getBlockPeriodDates = computed(() => {\n  const dates: Date[] = [];\n\n  if (!field.value.isHaveUnselectable) return dates;\n\n  const notAllowedDates = field.value.notAllowedDates;\n\n  if (\n    notAllowedDates &&\n    notAllowedDates.period &&\n    notAllowedDates.period.length\n  ) {\n    for (const period of notAllowedDates.period) {\n      const startDate = new Date(parseDate(period.start || \"\"));\n      const endDate = new Date(parseDate(period.end || \"\"));\n\n      for (\n        let d = new Date(startDate);\n        d <= endDate;\n        d.setDate(d.getDate() + 1)\n      ) {\n        dates.push(new Date(d));\n      }\n    }\n  }\n\n  return dates;\n});\n\nconst getTotalDisableDate = computed(() => {\n  return [...getBlockPeriodDates.value, ...getDisabledDates.value];\n});\n\nconst getDisplayValue = computed(() => {\n  if (!field.value.dayPriceEnabled) {\n    return displayValueHelper(date.value);\n  }\n\n  return field.value.useCurrency || field.value.fieldCurrency\n    ? singleFieldMixins.getCommonFieldDisplayView(field.value)\n    : field.value.value?.toString() || \"\";\n});\n\nconst getExtraDisplayValue = computed(() => {\n  if (field.value.dayPriceEnabled) {\n    const result: string[] = [displayValueHelper(date.value)];\n    const value =\n      field.value.useCurrency || field.value.fieldCurrency\n        ? singleFieldMixins.getCommonFieldDisplayView(field.value)\n        : field.value.value?.toString();\n\n    if (field.value.range && Array.isArray(date.value)) {\n      const dayDiff = getDaysDifference(\n        date.value[0] as Date,\n        date.value[1] as Date,\n        field.value,\n        getTotalDisableDate.value,\n        getDisabledWeekDays.value,\n      );\n\n      if (dayDiff) result.push(`${dayDiff} day(s) x ${field.value.dayPrice}`);\n    } else if (date.value) {\n      result.push(`1 day(s) x ${value}`);\n    }\n\n    return result;\n  }\n\n  return [];\n});\n\nconst getValue = computed(() => {\n  if (!field.value.dayPriceEnabled) return 0;\n\n  if (Array.isArray(date.value)) {\n    const differentDays = getDaysDifference(\n      date.value[0],\n      date.value[1],\n      field.value,\n      getTotalDisableDate.value,\n      getDisabledWeekDays.value,\n    );\n    return differentDays * field.value.dayPrice;\n  }\n\n  let val: number = date.value ? 1 : 0;\n  return val * field.value.dayPrice;\n});\n\nconst updateValue = (modelData: Date | Date[], alias?: string) => {\n  if (alias && alias !== field.value.alias) {\n    return;\n  }\n\n  field.value.selectedDate = modelData || undefined;\n  field.value.value = getValue.value;\n  field.value.displayValue = getDisplayValue.value;\n  field.value.extraDisplayView = getExtraDisplayValue.value;\n  fieldStore.updateField(field.value.alias, field.value);\n  conditionsStore.applyConditionForField(field.value.alias);\n};\n\nconst additionalClasses = computed(() => {\n  return field.value?.additionalStyles || \"\";\n});\n\ncallbackStore.add(\"updateDatePicker\", updateValue);\n</script>\n\n<style lang=\"scss\">\n.ccb-datePicker *:focus {\n  outline-width: 0;\n}\n\n.ccb-datePicker {\n  input {\n    padding: 12px var(--ccb-field-side-indent);\n    padding-left: max(30px, var(--ccb-field-side-indent)) !important;\n\n    @media only screen and (max-width: 480px) {\n      padding: 12px var(--ccb-mobile-field-side-indent);\n      padding-left: max(30px, var(--ccb-mobile-field-side-indent)) !important;\n    }\n\n    &.dp__input_focus {\n      border-color: var(--ccb-accent-color);\n    }\n\n    &::placeholder {\n      color: var(--ccb-text-color);\n    }\n  }\n\n  .dp__input_icon {\n    fill: var(--ccb-text-color);\n  }\n\n  .dp--menu-wrapper {\n    width: 100%;\n    left: 0 !important;\n    color: var(--ccb-text-color) !important;\n    max-width: 430px;\n  }\n\n  .dp__active_date {\n    background: var(--ccb-accent-color) !important;\n  }\n\n  .dp__arrow_bottom,\n  .dp__arrow_top {\n    border: none;\n    background-color: var(--ccb-fields-bg-color);\n  }\n\n  .dp__menu {\n    border: none;\n    box-shadow: 0 10px 30px 0 rgba(0, 0, 0, 0.25);\n    border-radius: 4px;\n  }\n\n  .dp__menu_inner {\n    background: var(--ccb-fields-bg-color);\n    border-radius: 4px;\n  }\n\n  .dp__overlay_action {\n    background: var(--ccb-fields-bg-color);\n\n    &:hover {\n      background: var(--ccb-accent-color);\n      color: var(--ccb-text-color);\n    }\n  }\n\n  .dp__overlay {\n    background: var(--ccb-fields-bg-color);\n    color: var(--ccb-text-color);\n\n    .dp__overlay_cell {\n      &:hover {\n        background: color-mix(\n          in srgb,\n          var(--ccb-accent-color),\n          transparent 50%\n        );\n        color: var(--ccb-text-color);\n      }\n    }\n  }\n\n  .dp__overlay_cell_active {\n    background: var(--ccb-accent-color);\n    color: var(--ccb-text-color);\n  }\n\n  .dp__action_row {\n    background: var(--ccb-fields-bg-color);\n\n    .dp__action_cancel {\n      padding: 10px;\n      margin: 0;\n      border: none;\n      flex: 1;\n      border-radius: var(--ccb-fields-border-radius);\n      cursor: pointer;\n      transition: 300ms ease;\n      font-size: var(--ccb-fields-button-size);\n      font-weight: var(--ccb-fields-button-weight);\n      border: 1px solid var(--ccb-fields-border-color);\n      margin-right: 10px;\n      background: var(--ccb-date-picker-day);\n      color: var(--ccb-text-color);\n\n      @media only screen and (max-width: 480px) {\n        font-size: var(--ccb-mobile-fields-button-size);\n        font-weight: var(--ccb-mobile-fields-button-weight);\n      }\n\n      &:hover {\n        background: color-mix(\n          in srgb,\n          var(--ccb-accent-color),\n          transparent 50%\n        );\n      }\n    }\n\n    .dp__action_select {\n      padding: 10px;\n      margin: 0;\n      border: none;\n      flex: 1;\n      border-radius: var(--ccb-fields-border-radius);\n      cursor: pointer;\n      transition: 300ms ease;\n      font-size: var(--ccb-fields-button-size);\n      font-weight: var(--ccb-fields-button-weight);\n      background: var(--ccb-accent-color);\n      color: var(--ccb-fields-bg-color);\n\n      @media only screen and (max-width: 480px) {\n        font-size: var(--ccb-mobile-fields-button-size);\n        font-weight: var(--ccb-mobile-fields-button-weight);\n      }\n\n      &:hover {\n        background: hsl(from var(--ccb-accent-color) h s calc(l - 5));\n      }\n    }\n  }\n\n  .dp__menu-inner {\n    padding: 10px;\n  }\n\n  .dp__pointer {\n    background: var(--ccb-fields-bg-color);\n  }\n\n  .dp__inner_nav {\n    background: var(--ccb-date-picker-day);\n    border-radius: 4px;\n  }\n\n  .dp__month_year_wrap {\n    gap: 4px;\n    .dp__month_year_select {\n      background: var(--ccb-date-picker-day);\n      border-radius: 4px;\n      height: 26px;\n      font-size: 14px;\n      font-weight: 700;\n\n      &:hover {\n        background: var(--ccb-accent-color) !important;\n      }\n    }\n  }\n\n  .dp__cell_inner {\n    width: auto !important;\n    border-radius: 0px;\n    font-size: 12px !important;\n    font-weight: 500;\n  }\n\n  .dp__range_start,\n  .dp__range_end {\n    background: var(--ccb-accent-color) !important;\n  }\n\n  .dp__range_between {\n    background: var(--ccb-date-picker-picket-day) !important;\n    color: var(--ccb-accent-color) !important;\n  }\n\n  .dp--arrow-btn-nav {\n    padding: 0px !important;\n\n    &:hover {\n      background: var(--ccb-accent-color) !important;\n    }\n  }\n\n  .dp__calendar_item,\n  .dp__calendar_header_item {\n    color: var(--ccb-text-color) !important;\n  }\n\n  .dp__calendar_header_item {\n    height: 22px;\n  }\n\n  .dp__calendar_item {\n    border: 2px solid transparent;\n    &:hover {\n      border: 2px solid var(--ccb-accent-color);\n      background: color-mix(in srgb, var(--ccb-accent-color), transparent 50%);\n      color: var(--ccb-text-color) !important;\n    }\n  }\n\n  .dp__date_hover {\n    &:hover {\n      color: var(--ccb-text-color) !important;\n    }\n  }\n\n  .dp__today {\n    border: none;\n  }\n\n  .dp__calendar_row {\n    margin: 0;\n  }\n\n  .dp__calendar_header_separator {\n    display: none;\n  }\n\n  .dp__calendar_header {\n    font-size: 12px;\n    font-weight: 500;\n    opacity: 0.3;\n  }\n}\n</style>\n"],"names":["props","__props","field","toRefs","appearanceStore","useAppearanceStore","fieldStore","useFieldsStore","conditionsStore","useConditionsStore","singleFieldMixins","useSingleField","callbackStore","useCallbackStore","translationsStore","useTranslationsStore","parseDate","getDaysDifference","displayValueHelper","useDatePickerFieldHelper","format","date","computed","value","isRequired","getPlaceholder","getDisabledWeekDays","_a","n","getDisabledDates","today","days","i","nDay","getMinDate","getBlockPeriodDates","dates","notAllowedDates","period","startDate","endDate","d","getTotalDisableDate","getDisplayValue","getExtraDisplayValue","result","dayDiff","getValue","updateValue","modelData","alias","additionalClasses"],"mappings":"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"}