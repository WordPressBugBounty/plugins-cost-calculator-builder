{"version":3,"file":"MultiPoint-LYvAOvkx.js","sources":["../../src/widget/features/calculator-fields/components/MultiRange/styles/MultiPoint.vue"],"sourcesContent":["<template>\n  <div\n    class=\"slider-wrapper ccb-multi-point-multi-range-field\"\n    :class=\"{ jump: field.jump }\"\n  >\n    <div class=\"slider-min-max\">\n      <div\n        class=\"slider-min-max-item\"\n        :class=\"{ first: modelValue[0] == min }\"\n        @click=\"handleMinClick(min)\"\n      >\n        <span class=\"tick\"></span>\n        <span class=\"label\">{{ min }}</span>\n      </div>\n      <div\n        class=\"slider-min-max-item\"\n        :class=\"{ done: modelValue[0] >= max }\"\n        @click=\"handleClick(max)\"\n      >\n        <span class=\"tick\"></span>\n        <span class=\"label\">{{ max }}</span>\n      </div>\n    </div>\n    <Slider\n      style=\"margin: 10px 0\"\n      :format=\"getFormatValue\"\n      :min=\"field.min\"\n      :max=\"field.max\"\n      :step=\"step\"\n      :disabled=\"field.disabled\"\n      :modelValue=\"modelValue\"\n      @update:modelValue=\"updateValue\"\n      show-tooltip=\"focus\"\n    ></Slider>\n    <div class=\"custom-marks\">\n      <div\n        v-for=\"point in scalePoints\"\n        :key=\"point\"\n        class=\"mark\"\n        :style=\"getMarkStyle(point)\"\n        v-if=\"field.scalePoints\"\n      >\n        <div\n          class=\"tick\"\n          v-if=\"point !== min && point !== max\"\n          :class=\"{\n            'tick-passed': point >= modelValue[0] && point <= modelValue[1],\n          }\"\n        />\n        <div\n          class=\"label\"\n          :class=\"{ 'label-passed': point <= modelValue[0] }\"\n          @click=\"handleClick(point)\"\n          v-if=\"point !== min && point !== max\"\n        >\n          {{ point }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { toRefs, ref, computed, watch } from \"vue\";\nimport { IMultiRangeField } from \"@/widget/shared/types/fields\";\nimport Slider from \"@vueform/slider\";\n\ntype Props = {\n  field: IMultiRangeField;\n  modelValue: number[];\n};\n\nconst props = defineProps<Props>();\nconst { field } = toRefs(props);\n\nconst step = computed(() =>\n  field.value.jump ? 1 : Number(field.value.step || 1),\n);\nconst min = computed(() => Number(field.value.min));\nconst max = computed(() => Number(field.value.max));\nconst realValue = ref(props.modelValue);\nconst jump = computed(() => field.value.jump);\n\nconst emit = defineEmits<{\n  (event: \"update:modelValue\", value: number[]): void;\n}>();\n\nconst updateValue = (val: number | number[]) => {\n  emit(\"update:modelValue\", Array.isArray(val) ? val : [val]);\n};\n\nconst getFormatValue = (num: number): string => {\n  const rounded = num.toFixed(2);\n  return parseFloat(rounded).toString();\n};\n\nconst scalePoints = computed(() => {\n  const raw = field.value.scalePoints?.trim() || \"\";\n  return raw\n    .split(\",\")\n    .map((p) => Number(p.trim()))\n    .filter((p) => !isNaN(p) && p >= min.value && p <= max.value);\n});\n\nconst getMarkStyle = (point: number) => {\n  const percentage = ((point - min.value) / (max.value - min.value)) * 100;\n  return {\n    left: `${percentage}%`,\n  };\n};\n\nwatch(\n  () => props.modelValue,\n  (val) => {\n    realValue.value = val;\n  },\n);\n\nconst handleClick = (point: number) => {\n  if (jump.value && scalePoints.value.includes(point)) {\n    emit(\"update:modelValue\", [realValue.value[0], point]);\n  }\n};\n\nconst handleMinClick = (point: number) => {\n  if (jump.value && scalePoints.value.includes(point)) {\n    emit(\"update:modelValue\", [point, realValue.value[1]]);\n  }\n};\n\nwatch(realValue, (val) => {\n  if (jump.value) {\n    const firstPoint = scalePoints.value.reduce(\n      (prev, curr) =>\n        Math.abs(curr - val[0]) < Math.abs(prev - val[0]) ? curr : prev,\n      scalePoints.value[0],\n    );\n    const secondPoint = scalePoints.value.reduce(\n      (prev, curr) =>\n        Math.abs(curr - val[1]) < Math.abs(prev - val[1]) ? curr : prev,\n      scalePoints.value[0],\n    );\n    const snapped = [firstPoint, secondPoint];\n\n    if (JSON.stringify(snapped) !== JSON.stringify(props.modelValue)) {\n      emit(\"update:modelValue\", snapped);\n    }\n  } else {\n    if (JSON.stringify(val) !== JSON.stringify(props.modelValue)) {\n      emit(\"update:modelValue\", val);\n    }\n  }\n});\n</script>\n\n<style lang=\"scss\">\n.ccb-multi-point-multi-range-field {\n  padding: 10px 0 25px 0 !important;\n  position: relative;\n\n  &.jump {\n    .custom-marks {\n      z-index: 2;\n    }\n\n    .slider-min-max-item {\n      .label {\n        cursor: pointer;\n        pointer-events: auto;\n      }\n    }\n\n    .slider-handle {\n      pointer-events: none;\n    }\n\n    .custom-marks {\n      .label {\n        cursor: pointer;\n        pointer-events: auto;\n      }\n    }\n  }\n  .slider-min-max {\n    display: flex;\n    width: 102%;\n    justify-content: space-between;\n    align-items: center;\n    position: absolute;\n    top: 18px;\n    left: 0;\n\n    &-item {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n\n      &.first {\n        .tick {\n          background: var(--ccb-accent-color);\n        }\n      }\n\n      &.done {\n        .tick {\n          background-color: var(--ccb-accent-color);\n        }\n      }\n    }\n\n    .tick {\n      height: 8px;\n      width: 8px;\n      border-radius: 50%;\n      background: color-mix(in srgb, var(--ccb-container-color), black 10%);\n      margin: 0 auto 4px;\n    }\n\n    .label {\n      color: var(--ccb-fields-description-color);\n      font-size: 12px;\n      font-weight: 500;\n      line-height: 100%;\n      padding-top: 10px;\n    }\n  }\n\n  .slider-origin {\n    width: 105%;\n    right: -13px;\n  }\n\n  .slider-base {\n    transform: scale(0.94);\n    background-color: color-mix(\n      in srgb,\n      var(--ccb-container-color),\n      black 10%\n    ) !important;\n  }\n  .slider-horizontal {\n    height: 4px !important;\n    border-radius: 10px;\n  }\n\n  .slider-tooltip {\n    border-radius: 15px;\n    font-size: 12px;\n    font-weight: 700;\n    padding: 6px 10px;\n    line-height: 100%;\n\n    &::after,\n    &::before {\n      display: none;\n    }\n  }\n\n  .custom-marks {\n    position: absolute;\n    right: -13px;\n    top: 18px;\n    width: 105%;\n    transform: scaleX(0.94);\n  }\n\n  .mark {\n    position: absolute;\n    transform: translateX(-50%);\n    text-align: center;\n\n    .label {\n      color: var(--ccb-fields-description-color);\n      font-size: 12px;\n      font-weight: 500;\n      line-height: 100%;\n      padding-top: 10px;\n    }\n  }\n\n  .tick {\n    height: 8px;\n    width: 8px;\n    border-radius: 50%;\n    background: color-mix(in srgb, var(--ccb-container-color), black 10%);\n    margin: 0 auto 4px;\n\n    &.tick-passed {\n      background: var(--ccb-accent-color) !important;\n    }\n  }\n}\n</style>\n"],"names":["props","__props","field","toRefs","step","computed","min","max","realValue","ref","jump","emit","__emit","updateValue","val","getFormatValue","num","rounded","scalePoints","_a","p","getMarkStyle","point","watch","handleClick","handleMinClick","firstPoint","prev","curr","secondPoint","snapped"],"mappings":"uaAwEA,MAAMA,EAAQC,EACR,CAAE,MAAAC,CAAA,EAAUC,EAAOH,CAAK,EAExBI,EAAOC,EAAS,IACpBH,EAAM,MAAM,KAAO,EAAI,OAAOA,EAAM,MAAM,MAAQ,CAAC,CACrD,EACMI,EAAMD,EAAS,IAAM,OAAOH,EAAM,MAAM,GAAG,CAAC,EAC5CK,EAAMF,EAAS,IAAM,OAAOH,EAAM,MAAM,GAAG,CAAC,EAC5CM,EAAYC,EAAIT,EAAM,UAAU,EAChCU,EAAOL,EAAS,IAAMH,EAAM,MAAM,IAAI,EAEtCS,EAAOC,EAIPC,EAAeC,GAA2B,CACzCH,EAAA,oBAAqB,MAAM,QAAQG,CAAG,EAAIA,EAAM,CAACA,CAAG,CAAC,CAC5D,EAEMC,EAAkBC,GAAwB,CACxC,MAAAC,EAAUD,EAAI,QAAQ,CAAC,EACtB,OAAA,WAAWC,CAAO,EAAE,SAAS,CACtC,EAEMC,EAAcb,EAAS,IAAM,OAE1B,SADKc,EAAAjB,EAAM,MAAM,cAAZ,YAAAiB,EAAyB,SAAU,IAE5C,MAAM,GAAG,EACT,IAAKC,GAAM,OAAOA,EAAE,KAAA,CAAM,CAAC,EAC3B,OAAQA,GAAM,CAAC,MAAMA,CAAC,GAAKA,GAAKd,EAAI,OAASc,GAAKb,EAAI,KAAK,CAAA,CAC/D,EAEKc,EAAgBC,IAEb,CACL,KAAM,IAFaA,EAAQhB,EAAI,QAAUC,EAAI,MAAQD,EAAI,OAAU,GAEhD,GACrB,GAGFiB,EACE,IAAMvB,EAAM,WACXc,GAAQ,CACPN,EAAU,MAAQM,CAAA,CAEtB,EAEM,MAAAU,EAAeF,GAAkB,CACjCZ,EAAK,OAASQ,EAAY,MAAM,SAASI,CAAK,GAChDX,EAAK,oBAAqB,CAACH,EAAU,MAAM,CAAC,EAAGc,CAAK,CAAC,CAEzD,EAEMG,EAAkBH,GAAkB,CACpCZ,EAAK,OAASQ,EAAY,MAAM,SAASI,CAAK,GAChDX,EAAK,oBAAqB,CAACW,EAAOd,EAAU,MAAM,CAAC,CAAC,CAAC,CAEzD,EAEM,OAAAe,EAAAf,EAAYM,GAAQ,CACxB,GAAIJ,EAAK,MAAO,CACR,MAAAgB,EAAaR,EAAY,MAAM,OACnC,CAACS,EAAMC,IACL,KAAK,IAAIA,EAAOd,EAAI,CAAC,CAAC,EAAI,KAAK,IAAIa,EAAOb,EAAI,CAAC,CAAC,EAAIc,EAAOD,EAC7DT,EAAY,MAAM,CAAC,CACrB,EACMW,EAAcX,EAAY,MAAM,OACpC,CAACS,EAAMC,IACL,KAAK,IAAIA,EAAOd,EAAI,CAAC,CAAC,EAAI,KAAK,IAAIa,EAAOb,EAAI,CAAC,CAAC,EAAIc,EAAOD,EAC7DT,EAAY,MAAM,CAAC,CACrB,EACMY,EAAU,CAACJ,EAAYG,CAAW,EAEpC,KAAK,UAAUC,CAAO,IAAM,KAAK,UAAU9B,EAAM,UAAU,GAC7DW,EAAK,oBAAqBmB,CAAO,CACnC,MAEI,KAAK,UAAUhB,CAAG,IAAM,KAAK,UAAUd,EAAM,UAAU,GACzDW,EAAK,oBAAqBG,CAAG,CAEjC,CACD"}