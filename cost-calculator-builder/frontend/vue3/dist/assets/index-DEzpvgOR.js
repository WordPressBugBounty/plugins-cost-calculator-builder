const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Default-BMAHZtNQ.css","./Small-DSRRxQjV.css","./Flat-D34CH-Ov.css","./Modern-Cx-KprRz.css","./Input-D72SYw4j.css","./MultiPoint-B-5NuffL.css"])))=>i.map(i=>d[i]);
import{a as X,C as Y,k as Z,o as ee,b as V,e as F,_ as $,m as S,g as h,p as y,q as C,f as O,L as te,D as M,u as l,r as ie,I as B}from"./convert-case-to-camel-case.utils-DRsbC-qG.js";import{c as ne,u as re,n as ae,m as se,d as ue,a as oe,l as le,o as ce}from"./widget-aE3IoCbC.js";import{_ as de}from"./RequiredHint.vue_vue_type_style_index_0_lang-DFYyucnB.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./translationsStore-C34buciO.js";const me={class:"ccb-field__label"},ve={class:"ccb-field__title"},fe={class:"ccb-field__title--title-box"},_e={key:0,class:"ccb-field-required-mark"},pe={key:0,class:"ccb-field__descriptions ccb-before"},ge={key:0,class:"ccb-field__description"},be={class:"ccb-field-input__wrapper"},ye={key:1,class:"ccb-field__descriptions ccb-after"},xe={class:"ccb-field__description"},he={class:"ccb-field__badge-content"},Ne={key:0,class:"ccb-icon-price-tag"},Pe={class:"ccb-field__badge-text"},Se={class:"ccb-field__badge-value"},Qe=X({__name:"Range",props:{field:{}},setup(L){const U=L,{field:e}=Y(U),A=ne(),q=re(),W=ae(),k=ce(),j=se(),g=le(),f=Z(0),z=ue();ee(()=>{f.value=e.value.originalValue?e.value.originalValue:e.value.min,D(f.value,void 0,!0)});const G=V(()=>{var a;return((a=oe().getWarningTexts)==null?void 0:a.requiredMsg)||""}),E=V(()=>{var c;const i=e.value.pricingStructure;if(!i||i==="no_discounts")return"";const a=e.value.pricingRanges||[];if(!a.length)return"";const s=Number(f.value)||0;if(s<=0)return"";const d=Math.max(...a.map(t=>Number(t.unitPrice)||0),Number(e.value.unit)||0),m=d*s;let x=0;if(i==="tiered_discounts"){const t=a.find(r=>{const u=Number(r.minQty)||0,b=Number(r.maxQty)||0;return s>=u&&s<=b});x=(Number((t==null?void 0:t.unitPrice)??e.value.unit)||0)*s}else if(i==="cumulative_discounts"){const t=[...a].sort((r,u)=>(Number(r.minQty)||0)-(Number(u.minQty)||0));let n=s;for(const r of t){const u=Number(r.minQty),b=Number.isFinite(u)?u:0,T=Math.max(1,b),N=Number(r.maxQty),Q=Number.isFinite(N)&&N>0?N:1/0,I=isFinite(Q)?Math.max(0,Q-T+1):n,R=Math.max(0,Math.min(n,I));if(R>0&&(x+=R*(Number(r.unitPrice)||0),n-=R),n<=0)break}n>0&&(x+=n*d)}else if(i==="flat_rate_discounts"){const t=a.find(r=>{const u=Number(r.minQty)||0,b=Number(r.maxQty)||0;return s>=u&&s<=b});x=Number((t==null?void 0:t.unitPrice)??e.value.unit)||0}let v=0,p=0;if(i==="flat_rate_discounts"){const t=a.find(r=>{const u=Number(r.minQty)||0,b=Number(r.maxQty)||0;return s>=u&&s<=b}),n=Number((t==null?void 0:t.unitPrice)??e.value.unit)||0;v=Math.max(0,d-n),p=d>0?Math.round(v/d*100):0}else v=Math.max(0,m-x),p=m>0?Math.round(v/m*100):0;if(v<=0)return"";const P=g.getCurrencyOptions(e.value),_=g.formatCurrency(v,P),o=((c=e.value)==null?void 0:c.badgeFormat)||"$";return o==="symbol"?`${_}`:o==="percent"?`${p}%`:o==="symbol_and_percent"?`${_} (${p}%)`:""}),H=V(()=>{var a,s;const i=((s=(a=e.value)==null?void 0:a.styles)==null?void 0:s.style)||"default";return i==="default"?F(()=>$(()=>import("./Default-BKilHMsi.js"),__vite__mapDeps([0]),import.meta.url)):i==="small"?F(()=>$(()=>import("./Small-qlxAUNcm.js"),__vite__mapDeps([1]),import.meta.url)):i==="flat-minimal"?F(()=>$(()=>import("./Flat-C7ePYozM.js"),__vite__mapDeps([2]),import.meta.url)):i==="modern"?F(()=>$(()=>import("./Modern-RbbGHx1f.js"),__vite__mapDeps([3]),import.meta.url)):i==="input"?F(()=>$(()=>import("./Input-CTC2VZrw.js"),__vite__mapDeps([4]),import.meta.url)):i==="multi-point"?F(()=>$(()=>import("./MultiPoint-D_PVkQ4e.js"),__vite__mapDeps([5]),import.meta.url)):""}),D=(i,a,s)=>{if(a&&a!==e.value.alias)return;(!a||s)&&(f.value=i,e.value.originalValue=i);const d=e.value.pricingStructure;if((d==="tiered_discounts"||d==="cumulative_discounts"||d==="flat_rate_discounts")&&Array.isArray(e.value.pricingRanges)){const m=Number(e.value.originalValue??f.value)||0,x=e.value.pricingRanges||[];let v=0,p=[];const P=g.getCurrencyOptions(e.value);if(d==="tiered_discounts"){const _=x.find(n=>{const r=Number(n.minQty)||0,u=Number(n.maxQty)||0;return m>=r&&m<=u}),o=Number((_==null?void 0:_.unitPrice)??e.value.unit)||0;v=m*o;const c=k.parseCommonFieldSign(m.toString(),e.value.sign,e.value.unitPosition),t=g.formatCurrency(o,P);p.push(`${c} x ${t}`)}else if(d==="cumulative_discounts"){const _=[...x].sort((c,t)=>(Number(c.minQty)||0)-(Number(t.minQty)||0));let o=m;for(const c of _){const t=Number(c.minQty),n=Number.isFinite(t)?t:0,r=Math.max(1,n),u=Number(c.maxQty),b=Number.isFinite(u)&&u>0?u:1/0,T=isFinite(b)?Math.max(0,b-r+1):o,N=Math.max(0,Math.min(o,T));if(N>0){const Q=Number(c.unitPrice)||0;v+=N*Q;const I=k.parseCommonFieldSign(N.toString(),e.value.sign,e.value.unitPosition),R=g.formatCurrency(Q,P);p.push(`${I} x ${R}`),o-=N}if(o<=0)break}if(o>0){const c=Number(e.value.unit)||0;v+=o*c;const t=k.parseCommonFieldSign(o.toString(),e.value.sign,e.value.unitPosition),n=g.formatCurrency(c,P);p.push(`${t} x ${n}`)}}else if(d==="flat_rate_discounts")if(m>0){const _=x.find(n=>{const r=Number(n.minQty)||0,u=Number(n.maxQty)||0;return m>=r&&m<=u}),o=Number((_==null?void 0:_.unitPrice)??e.value.unit)||0;v=o;const c=k.parseCommonFieldSign(m.toString(),e.value.sign,e.value.unitPosition),t=g.formatCurrency(o,P);p.push(`${c} â†’ ${t}`)}else v=0;e.value.value=e.value.round?Math.round(v):v,e.value.displayValue=g.formatCurrency(e.value.value||0,P),e.value.extraDisplayView=m>0&&p.length?p.join(" + "):""}else e.value.multiply&&(i=i*e.value.unit),e.value.value=e.value.round?Math.round(i||0):i||0,e.value.displayValue=k.getCommonFieldDisplayView(e.value,f.value.toString());A.updateField(e.value.alias,e.value,s),W.applyConditionForField(e.value.alias),A.getPageBreakEnabled&&A.getActivePage.action==="not_skip"&&z.checkPageFieldsConditions()},J=V(()=>e.value.multipliedTotal?e.value.useCurrency||e.value.fieldCurrency?g.formatCurrency(e.value.value,g.getCurrencyOptions(e.value)):k.parseCommonFieldSign(e.value.value.toString(),e.value.sign,e.value.unitPosition):e.value.useCurrency||e.value.fieldCurrency?e.value.unitPosition==="left"?`${e.value.sign} ${f.value}`:`${f.value} ${e.value.sign}`:e.value.unitPosition==="left"?`${e.value.sign} ${f.value}`:`${f.value} ${e.value.sign}`),w=V(()=>A.checkFieldRequired(e.value)),K=V(()=>{var i;return((i=e.value)==null?void 0:i.additionalStyles)||""});return j.add("updateRange",D),(i,a)=>{var s;return h(),S("div",{class:B(["ccb-field ccb-range-field",{required:w.value,"ccb-field-disabled":l(e).disabled,[K.value]:!0,[(s=l(e).styles)==null?void 0:s.style]:!0,"has-badge":!!E.value}])},[y("div",me,[w.value?(h(),O(de,{key:0,text:G.value},null,8,["text"])):C("",!0),y("div",ve,[y("span",fe,[y("span",null,[te(M(l(e).label),1),l(e).required?(h(),S("span",_e,"*")):C("",!0)]),y("span",null,M(J.value),1)])])]),l(q).getAppearanceDescriptionPosition==="before"?(h(),S("div",pe,[l(e).description?(h(),S("div",ge,M(l(e).description),1)):C("",!0)])):C("",!0),y("div",be,[(h(),O(ie(H.value),{field:l(e),"onUpdate:modelValue":[D,a[0]||(a[0]=d=>f.value=d)],modelValue:f.value},null,8,["field","modelValue"]))]),l(q).getAppearanceDescriptionPosition==="after"&&l(e).description&&l(e).description.length>0?(h(),S("div",ye,[y("div",xe,M(l(e).description),1)])):C("",!0),E.value&&!l(e).multiply?(h(),S("div",{key:2,class:B(["ccb-field__badge",l(e).badgeVariant])},[y("div",he,[l(e).badgeVariant==="primary"?(h(),S("i",Ne)):C("",!0),y("div",Pe,M(l(e).badgeText)+":",1),y("div",Se,M(E.value),1)])],2)):C("",!0)],2)}}});export{Qe as default};
//# sourceMappingURL=index-DEzpvgOR.js.map
